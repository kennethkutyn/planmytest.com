var amplitudeAutocapturePlugin=function(e){"use strict";var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},t(e,n)};function n(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}var r=function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)};function i(e,t,n,r){return new(n||(n=Promise))((function(i,o){function u(e){try{l(r.next(e))}catch(e){o(e)}}function c(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(u,c)}l((r=r.apply(e,t||[])).next())}))}function o(e,t){var n,r,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},u=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return u.next=c(0),u.throw=c(1),u.return=c(2),"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function c(c){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;u&&(u=0,c[0]&&(o=0)),o;)try{if(n=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3])){o.label=c[1];break}if(6===c[0]&&o.label<i[1]){o.label=i[1],i=c;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(c);break}i[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(e){c=[6,e],r=0}finally{n=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}}function u(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function c(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),u=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)u.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return u}function l(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function s(e){return this instanceof s?(this.v=e,this):new s(e)}function a(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),o=[];return r=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",(function(e){return function(t){return Promise.resolve(t).then(e,a)}})),r[Symbol.asyncIterator]=function(){return this},r;function u(e,t){i[e]&&(r[e]=function(t){return new Promise((function(n,r){o.push([e,t,n,r])>1||c(e,t)}))},t&&(r[e]=t(r[e])))}function c(e,t){try{(n=i[e](t)).value instanceof s?Promise.resolve(n.value.v).then(l,a):d(o[0][2],n)}catch(e){d(o[0][3],e)}var n}function l(e){c("next",e)}function a(e){c("throw",e)}function d(e,t){e(t),o.shift(),o.length&&c(o[0][0],o[0][1])}}function d(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=u(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,i){(function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)})(r,i,(t=e[n](t)).done,t.value)}))}}}"function"==typeof SuppressedError&&SuppressedError;var f,v,h=function(e,t){return!t||!t.length||t.some((function(t){return"string"==typeof t?e===t:e.match(t)}))},p=["a","button","input","select","textarea","label","video","audio",'[contenteditable="true" i]',"[data-amp-default-track]",".amp-default-track"],y="data-amp-track-",b=["div","span","h1","h2","h3","h4","h5","h6"],m=l(['input[type="button"]','input[type="submit"]','input[type="reset"]','input[type="image"]','input[type="file"]'],c(["a","button",'[role="button"]','[role="link"]','[role="menuitem"]','[role="menuitemcheckbox"]','[role="menuitemradio"]','[role="option"]','[role="tab"]','[role="treeitem"]','[contenteditable="true" i]']),!1),g=["*"];!function(e){e.US="US",e.EU="EU",e.STAGING="STAGING"}(f||(f={})),function(e){e.Unknown="unknown",e.Skipped="skipped",e.Success="success",e.RateLimit="rate_limit",e.PayloadTooLarge="payload_too_large",e.Invalid="invalid",e.Failed="failed",e.Timeout="Timeout",e.SystemError="SystemError"}(v||(v={}));var w=function(){function e(){}return e.prototype.send=function(e,t){return Promise.resolve(null)},e.prototype.buildResponse=function(e){var t,n,r,i,o,u,c,l,s,a,d,f,h,p,y,b,m,g,w,x,_,E;if("object"!=typeof e)return null;var A=e.code||0,S=this.buildStatus(A);switch(S){case v.Success:return{status:S,statusCode:A,body:{eventsIngested:null!==(t=e.events_ingested)&&void 0!==t?t:0,payloadSizeBytes:null!==(n=e.payload_size_bytes)&&void 0!==n?n:0,serverUploadTime:null!==(r=e.server_upload_time)&&void 0!==r?r:0}};case v.Invalid:return{status:S,statusCode:A,body:{error:null!==(i=e.error)&&void 0!==i?i:"",missingField:null!==(o=e.missing_field)&&void 0!==o?o:"",eventsWithInvalidFields:null!==(u=e.events_with_invalid_fields)&&void 0!==u?u:{},eventsWithMissingFields:null!==(c=e.events_with_missing_fields)&&void 0!==c?c:{},eventsWithInvalidIdLengths:null!==(l=e.events_with_invalid_id_lengths)&&void 0!==l?l:{},epsThreshold:null!==(s=e.eps_threshold)&&void 0!==s?s:0,exceededDailyQuotaDevices:null!==(a=e.exceeded_daily_quota_devices)&&void 0!==a?a:{},silencedDevices:null!==(d=e.silenced_devices)&&void 0!==d?d:[],silencedEvents:null!==(f=e.silenced_events)&&void 0!==f?f:[],throttledDevices:null!==(h=e.throttled_devices)&&void 0!==h?h:{},throttledEvents:null!==(p=e.throttled_events)&&void 0!==p?p:[]}};case v.PayloadTooLarge:return{status:S,statusCode:A,body:{error:null!==(y=e.error)&&void 0!==y?y:""}};case v.RateLimit:return{status:S,statusCode:A,body:{error:null!==(b=e.error)&&void 0!==b?b:"",epsThreshold:null!==(m=e.eps_threshold)&&void 0!==m?m:0,throttledDevices:null!==(g=e.throttled_devices)&&void 0!==g?g:{},throttledUsers:null!==(w=e.throttled_users)&&void 0!==w?w:{},exceededDailyQuotaDevices:null!==(x=e.exceeded_daily_quota_devices)&&void 0!==x?x:{},exceededDailyQuotaUsers:null!==(_=e.exceeded_daily_quota_users)&&void 0!==_?_:{},throttledEvents:null!==(E=e.throttled_events)&&void 0!==E?E:[]}};case v.Timeout:default:return{status:S,statusCode:A}}},e.prototype.buildStatus=function(e){return e>=200&&e<300?v.Success:429===e?v.RateLimit:413===e?v.PayloadTooLarge:408===e?v.Timeout:e>=400&&e<500?v.Invalid:e>=500?v.Failed:v.Unknown},e}(),x="Remote config fetch rejected due to timeout after 5 seconds",_="Unexpected error occurred",E=function(){function e(e){var t=e.localConfig,n=e.configKeys,c=this;this.retryTimeout=1e3,this.attempts=0,this.sessionTargetingMatch=!1,this.metrics={},this.getRemoteNamespaceConfig=function(e,t){return i(c,void 0,void 0,(function(){var n,r,i;return o(this,(function(o){switch(o.label){case 0:return n=Date.now(),[4,this.fetchWithTimeout(t)];case 1:return(r=o.sent())&&(i=r.configs&&r.configs[e])?(this.metrics.fetchTimeAPISuccess=Date.now()-n,[2,i]):(this.metrics.fetchTimeAPIFail=Date.now()-n,[2,void 0])}}))}))},this.getRemoteConfig=function(e,t,n){return i(c,void 0,void 0,(function(){var r;return o(this,(function(i){switch(i.label){case 0:return[4,this.getRemoteNamespaceConfig(e,n)];case 1:return[2,null==(r=i.sent())?void 0:r[t]]}}))}))},this.fetchWithTimeout=function(e){return i(c,void 0,void 0,(function(){var t,n,r;return o(this,(function(i){switch(i.label){case 0:return t=new AbortController,n=setTimeout((function(){return t.abort()}),5e3),[4,this.fetchRemoteConfig(t.signal,e)];case 1:return r=i.sent(),clearTimeout(n),[2,r]}}))}))},this.fetchRemoteConfig=function(e,t){return i(c,void 0,void 0,(function(){var n,i,c,l,s,a,d,f,h,p,y,b;return o(this,(function(o){switch(o.label){case 0:if(t===this.lastFetchedSessionId&&this.attempts>=this.localConfig.flushMaxRetries)return[2,this.completeRequest({err:"Remote config fetch rejected due to exceeded retry count"})];if(e.aborted)return[2,this.completeRequest({err:x})];t!==this.lastFetchedSessionId&&(this.lastFetchedSessionId=t,this.attempts=0),o.label=1;case 1:o.trys.push([1,3,,4]),n=new URLSearchParams({api_key:this.localConfig.apiKey});try{for(i=u(this.configKeys),c=i.next();!c.done;c=i.next())l=c.value,n.append("config_keys",l)}catch(e){p={error:e}}finally{try{c&&!c.done&&(y=i.return)&&y.call(i)}finally{if(p)throw p.error}}return t&&n.set("session_id",String(t)),s={headers:{Accept:"*/*"},method:"GET"},a="".concat(this.getServerUrl(),"?").concat(n.toString()),this.attempts+=1,[4,fetch(a,r(r({},s),{signal:e}))];case 2:if(null===(d=o.sent()))return[2,this.completeRequest({err:_})];switch((new w).buildStatus(d.status)){case v.Success:return this.attempts=0,[2,this.parseAndStoreConfig(d)];case v.Failed:return[2,this.retryFetch(e,t)];default:return[2,this.completeRequest({err:"Network error occurred, remote config fetch failed"})]}case 3:return f=o.sent(),h=f,e.aborted?[2,this.completeRequest({err:x})]:[2,this.completeRequest({err:null!==(b=h.message)&&void 0!==b?b:_})];case 4:return[2]}}))}))},this.retryFetch=function(e,t){return i(c,void 0,void 0,(function(){var n=this;return o(this,(function(r){switch(r.label){case 0:return[4,new Promise((function(e){return setTimeout(e,n.attempts*n.retryTimeout)}))];case 1:return r.sent(),[2,this.fetchRemoteConfig(e,t)]}}))}))},this.parseAndStoreConfig=function(e){return i(c,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return[4,e.json()];case 1:return t=n.sent(),this.completeRequest({success:"Remote config successfully fetched"}),[2,t]}}))}))},this.localConfig=t,this.configKeys=n}return e.prototype.getServerUrl=function(){return this.localConfig.configServerUrl?this.localConfig.configServerUrl:this.localConfig.serverZone===f.STAGING?"https://sr-client-cfg.stag2.amplitude.com/config":this.localConfig.serverZone===f.EU?"https://sr-client-cfg.eu.amplitude.com/config":"https://sr-client-cfg.amplitude.com/config"},e.prototype.completeRequest=function(e){var t=e.err,n=e.success;if(t)throw new Error(t);n&&this.localConfig.loggerProvider.log(n)},e}(),A=function(e){var t=e.localConfig,n=e.configKeys;return i(void 0,void 0,void 0,(function(){return o(this,(function(e){return[2,new E({localConfig:t,configKeys:n})]}))}))},S="[Amplitude] Element Clicked",T="[Amplitude] Rage Click",k="[Amplitude] Element Tag",C="[Amplitude] Element Text",O="[Amplitude] Page URL",P="https://app.amplitude.com",I={US:P,EU:"https://app.eu.amplitude.com",STAGING:"https://apps.stag2.amplitude.com"},M="data-amp-mask-attributes",R="data-amp-mask",L="*****";function j(e){return"function"==typeof e}function F(e){var t=e((function(e){Error.call(e),e.stack=(new Error).stack}));return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var q=F((function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}}));function D(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var N=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}var t;return e.prototype.unsubscribe=function(){var e,t,n,r,i;if(!this.closed){this.closed=!0;var o=this._parentage;if(o)if(this._parentage=null,Array.isArray(o))try{for(var s=u(o),a=s.next();!a.done;a=s.next()){a.value.remove(this)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}else o.remove(this);var d=this.initialTeardown;if(j(d))try{d()}catch(e){i=e instanceof q?e.errors:[e]}var f=this._finalizers;if(f){this._finalizers=null;try{for(var v=u(f),h=v.next();!h.done;h=v.next()){var p=h.value;try{W(p)}catch(e){i=null!=i?i:[],e instanceof q?i=l(l([],c(i)),c(e.errors)):i.push(e)}}}catch(e){n={error:e}}finally{try{h&&!h.done&&(r=v.return)&&r.call(v)}finally{if(n)throw n.error}}}if(i)throw new q(i)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)W(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&D(t,e)},e.prototype.remove=function(t){var n=this._finalizers;n&&D(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e}(),U=N.EMPTY;function z(e){return e instanceof N||e&&"closed"in e&&j(e.remove)&&j(e.add)&&j(e.unsubscribe)}function W(e){j(e)?e():e.unsubscribe()}var Y={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},H=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout.apply(void 0,l([e,t],c(n)))};function V(e){H((function(){throw e}))}function B(){}function G(e){e()}var K=function(e){function t(t){var n=e.call(this)||this;return n.isStopped=!1,t?(n.destination=t,z(t)&&t.add(n)):n.destination=ee,n}return n(t,e),t.create=function(e,t,n){return new Q(e,t,n)},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(N),X=Function.prototype.bind;function Z(e,t){return X.call(e,t)}var J=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){$(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){$(e)}else $(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){$(e)}},e}(),Q=function(e){function t(t,n,r){var i,o,u=e.call(this)||this;j(t)||!t?i={next:null!=t?t:void 0,error:null!=n?n:void 0,complete:null!=r?r:void 0}:u&&Y.useDeprecatedNextContext?((o=Object.create(t)).unsubscribe=function(){return u.unsubscribe()},i={next:t.next&&Z(t.next,o),error:t.error&&Z(t.error,o),complete:t.complete&&Z(t.complete,o)}):i=t;return u.destination=new J(i),u}return n(t,e),t}(K);function $(e){V(e)}var ee={closed:!0,next:B,error:function(e){throw e},complete:B},te="function"==typeof Symbol&&Symbol.observable||"@@observable";function ne(e){return e}var re=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var r,i=this,o=(r=e)&&r instanceof K||function(e){return e&&j(e.next)&&j(e.error)&&j(e.complete)}(r)&&z(r)?e:new Q(e,t,n);return G((function(){var e=i,t=e.operator,n=e.source;o.add(t?t.call(o,n):n?i._subscribe(o):i._trySubscribe(o))})),o},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=ie(t))((function(t,r){var i=new Q({next:function(t){try{e(t)}catch(e){r(e),i.unsubscribe()}},error:r,complete:t});n.subscribe(i)}))},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[te]=function(){return this},e.prototype.pipe=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(0===(e=t).length?ne:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)})(this)},e.prototype.toPromise=function(e){var t=this;return new(e=ie(e))((function(e,n){var r;t.subscribe((function(e){return r=e}),(function(e){return n(e)}),(function(){return e(r)}))}))},e.create=function(t){return new e(t)},e}();function ie(e){var t;return null!==(t=null!=e?e:Y.Promise)&&void 0!==t?t:Promise}function oe(e){return j(null==e?void 0:e.lift)}function ue(e){return function(t){if(oe(t))return t.lift((function(t){try{return e(t,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")}}function ce(e,t,n,r,i){return new le(e,t,n,r,i)}var le=function(e){function t(t,n,r,i,o,u){var c=e.call(this,t)||this;return c.onFinalize=o,c.shouldUnsubscribe=u,c._next=n?function(e){try{n(e)}catch(e){t.error(e)}}:e.prototype._next,c._error=i?function(e){try{i(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,c._complete=r?function(){try{r()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,c}return n(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(K);!function(e){function t(t,n){var r=e.call(this)||this;return r.source=t,r.subjectFactory=n,r._subject=null,r._refCount=0,r._connection=null,oe(t)&&(r.lift=t.lift),r}n(t,e),t.prototype._subscribe=function(e){return this.getSubject().subscribe(e)},t.prototype.getSubject=function(){var e=this._subject;return e&&!e.isStopped||(this._subject=this.subjectFactory()),this._subject},t.prototype._teardown=function(){this._refCount=0;var e=this._connection;this._subject=this._connection=null,null==e||e.unsubscribe()},t.prototype.connect=function(){var e=this,t=this._connection;if(!t){t=this._connection=new N;var n=this.getSubject();t.add(this.source.subscribe(ce(n,void 0,(function(){e._teardown(),n.complete()}),(function(t){e._teardown(),n.error(t)}),(function(){return e._teardown()})))),t.closed&&(this._connection=null,t=N.EMPTY)}return t},t.prototype.refCount=function(){return ue((function(e,t){var n=null;e._refCount++;var r=ce(t,void 0,void 0,void 0,(function(){if(!e||e._refCount<=0||0<--e._refCount)n=null;else{var r=e._connection,i=n;n=null,!r||i&&r!==i||r.unsubscribe(),t.unsubscribe()}}));e.subscribe(r),r.closed||(n=e.connect())}))(this)}}(re);var se,ae={now:function(){return(ae.delegate||performance).now()},delegate:void 0},de={schedule:function(e){var t=requestAnimationFrame,n=cancelAnimationFrame,r=t((function(t){n=void 0,e(t)}));return new N((function(){return null==n?void 0:n(r)}))},requestAnimationFrame:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=de.delegate;return((null==n?void 0:n.requestAnimationFrame)||requestAnimationFrame).apply(void 0,l([],c(e)))},cancelAnimationFrame:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return cancelAnimationFrame.apply(void 0,l([],c(e)))},delegate:void 0};new re((function(e){var t=se||ae,n=t.now(),r=0,i=function(){e.closed||(r=de.requestAnimationFrame((function(o){r=0;var u=t.now();e.next({timestamp:se?u:o,elapsed:u-n}),i()})))};return i(),function(){r&&de.cancelAnimationFrame(r)}}));var fe=F((function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}})),ve=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return n(t,e),t.prototype.lift=function(e){var t=new he(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new fe},t.prototype.next=function(e){var t=this;G((function(){var n,r;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var i=u(t.currentObservers),o=i.next();!o.done;o=i.next()){o.value.next(e)}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}}))},t.prototype.error=function(e){var t=this;G((function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var n=t.observers;n.length;)n.shift().error(e)}}))},t.prototype.complete=function(){var e=this;G((function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}}))},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,n=this,r=n.hasError,i=n.isStopped,o=n.observers;return r||i?U:(this.currentObservers=null,o.push(e),new N((function(){t.currentObservers=null,D(o,e)})))},t.prototype._checkFinalizedStatuses=function(e){var t=this,n=t.hasError,r=t.thrownError,i=t.isStopped;n?e.error(r):i&&e.complete()},t.prototype.asObservable=function(){var e=new re;return e.source=this,e},t.create=function(e,t){return new he(e,t)},t}(re),he=function(e){function t(t,n){var r=e.call(this)||this;return r.destination=t,r.source=n,r}return n(t,e),t.prototype.next=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)},t.prototype.error=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)},t.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},t.prototype._subscribe=function(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:U},t}(ve);!function(e){function t(t){var n=e.call(this)||this;return n._value=t,n}n(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(t){var n=e.prototype._subscribe.call(this,t);return!n.closed&&t.next(this._value),n},t.prototype.getValue=function(){var e=this,t=e.hasError,n=e.thrownError,r=e._value;if(t)throw n;return this._throwIfClosed(),r},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)}}(ve);var pe={now:function(){return(pe.delegate||Date).now()},delegate:void 0};!function(e){function t(t,n,r){void 0===t&&(t=1/0),void 0===n&&(n=1/0),void 0===r&&(r=pe);var i=e.call(this)||this;return i._bufferSize=t,i._windowTime=n,i._timestampProvider=r,i._buffer=[],i._infiniteTimeWindow=!0,i._infiniteTimeWindow=n===1/0,i._bufferSize=Math.max(1,t),i._windowTime=Math.max(1,n),i}n(t,e),t.prototype.next=function(t){var n=this,r=n.isStopped,i=n._buffer,o=n._infiniteTimeWindow,u=n._timestampProvider,c=n._windowTime;r||(i.push(t),!o&&i.push(u.now()+c)),this._trimBuffer(),e.prototype.next.call(this,t)},t.prototype._subscribe=function(e){this._throwIfClosed(),this._trimBuffer();for(var t=this._innerSubscribe(e),n=this._infiniteTimeWindow,r=this._buffer.slice(),i=0;i<r.length&&!e.closed;i+=n?1:2)e.next(r[i]);return this._checkFinalizedStatuses(e),t},t.prototype._trimBuffer=function(){var e=this,t=e._bufferSize,n=e._timestampProvider,r=e._buffer,i=e._infiniteTimeWindow,o=(i?1:2)*t;if(t<1/0&&o<r.length&&r.splice(0,r.length-o),!i){for(var u=n.now(),c=0,l=1;l<r.length&&r[l]<=u;l+=2)c=l;c&&r.splice(0,c+1)}}}(ve),function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._value=null,t._hasValue=!1,t._isComplete=!1,t}n(t,e),t.prototype._checkFinalizedStatuses=function(e){var t=this,n=t.hasError,r=t._hasValue,i=t._value,o=t.thrownError,u=t.isStopped,c=t._isComplete;n?e.error(o):(u||c)&&(r&&e.next(i),e.complete())},t.prototype.next=function(e){this.isStopped||(this._value=e,this._hasValue=!0)},t.prototype.complete=function(){var t=this,n=t._hasValue,r=t._value;t._isComplete||(this._isComplete=!0,n&&e.prototype.next.call(this,r),e.prototype.complete.call(this))}}(ve);var ye,be=function(e){function t(t,n){return e.call(this)||this}return n(t,e),t.prototype.schedule=function(e,t){return this},t}(N),me=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setInterval.apply(void 0,l([e,t],c(n)))},ge=function(e){return clearInterval(e)},we=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r.pending=!1,r}return n(t,e),t.prototype.schedule=function(e,t){var n;if(void 0===t&&(t=0),this.closed)return this;this.state=e;var r=this.id,i=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(i,r,t)),this.pending=!0,this.delay=t,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(i,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),me(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!=n&&this.delay===n&&!1===this.pending)return t;null!=t&&ge(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n,r=!1;try{this.work(e)}catch(e){r=!0,n=e||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),n},t.prototype.unsubscribe=function(){if(!this.closed){var t=this.id,n=this.scheduler,r=n.actions;this.work=this.state=this.scheduler=null,this.pending=!1,D(r,this),null!=t&&(this.id=this.recycleAsyncId(n,t,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(be),xe=1,_e={};function Ee(e){return e in _e&&(delete _e[e],!0)}var Ae=function(e){var t=xe++;return _e[t]=!0,ye||(ye=Promise.resolve()),ye.then((function(){return Ee(t)&&e()})),t},Se=function(e){Ee(e)},Te={setImmediate:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Te.delegate;return((null==n?void 0:n.setImmediate)||Ae).apply(void 0,l([],c(e)))},clearImmediate:function(e){return Se(e)},delegate:void 0},ke=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r}return n(t,e),t.prototype.requestAsyncId=function(t,n,r){return void 0===r&&(r=0),null!==r&&r>0?e.prototype.requestAsyncId.call(this,t,n,r):(t.actions.push(this),t._scheduled||(t._scheduled=Te.setImmediate(t.flush.bind(t,void 0))))},t.prototype.recycleAsyncId=function(t,n,r){var i;if(void 0===r&&(r=0),null!=r?r>0:this.delay>0)return e.prototype.recycleAsyncId.call(this,t,n,r);var o=t.actions;null!=n&&(null===(i=o[o.length-1])||void 0===i?void 0:i.id)!==n&&(Te.clearImmediate(n),t._scheduled===n&&(t._scheduled=void 0))},t}(we),Ce=function(){function e(t,n){void 0===n&&(n=e.now),this.schedulerActionCtor=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.schedulerActionCtor(this,e).schedule(n,t)},e.now=pe.now,e}(),Oe=function(e){function t(t,n){void 0===n&&(n=Ce.now);var r=e.call(this,t,n)||this;return r.actions=[],r._active=!1,r}return n(t,e),t.prototype.flush=function(e){var t=this.actions;if(this._active)t.push(e);else{var n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}},t}(Ce),Pe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.flush=function(e){this._active=!0;var t=this._scheduled;this._scheduled=void 0;var n,r=this.actions;e=e||r.shift();do{if(n=e.execute(e.state,e.delay))break}while((e=r[0])&&e.id===t&&r.shift());if(this._active=!1,n){for(;(e=r[0])&&e.id===t&&r.shift();)e.unsubscribe();throw n}},t}(Oe);new Pe(ke);var Ie=new Oe(we),Me=Ie,Re=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r}return n(t,e),t.prototype.schedule=function(t,n){return void 0===n&&(n=0),n>0?e.prototype.schedule.call(this,t,n):(this.delay=n,this.state=t,this.scheduler.flush(this),this)},t.prototype.execute=function(t,n){return n>0||this.closed?e.prototype.execute.call(this,t,n):this._execute(t,n)},t.prototype.requestAsyncId=function(t,n,r){return void 0===r&&(r=0),null!=r&&r>0||null==r&&this.delay>0?e.prototype.requestAsyncId.call(this,t,n,r):(t.flush(this),0)},t}(we),Le=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(Oe);new Le(Re);var je=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r}return n(t,e),t.prototype.requestAsyncId=function(t,n,r){return void 0===r&&(r=0),null!==r&&r>0?e.prototype.requestAsyncId.call(this,t,n,r):(t.actions.push(this),t._scheduled||(t._scheduled=de.requestAnimationFrame((function(){return t.flush(void 0)}))))},t.prototype.recycleAsyncId=function(t,n,r){var i;if(void 0===r&&(r=0),null!=r?r>0:this.delay>0)return e.prototype.recycleAsyncId.call(this,t,n,r);var o=t.actions;null!=n&&n===t._scheduled&&(null===(i=o[o.length-1])||void 0===i?void 0:i.id)!==n&&(de.cancelAnimationFrame(n),t._scheduled=void 0)},t}(we),Fe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.flush=function(e){var t;this._active=!0,e?t=e.id:(t=this._scheduled,this._scheduled=void 0);var n,r=this.actions;e=e||r.shift();do{if(n=e.execute(e.state,e.delay))break}while((e=r[0])&&e.id===t&&r.shift());if(this._active=!1,n){for(;(e=r[0])&&e.id===t&&r.shift();)e.unsubscribe();throw n}},t}(Oe);new Fe(je),function(e){function t(t,n){void 0===t&&(t=qe),void 0===n&&(n=1/0);var r=e.call(this,t,(function(){return r.frame}))||this;return r.maxFrames=n,r.frame=0,r.index=-1,r}n(t,e),t.prototype.flush=function(){for(var e,t,n=this.actions,r=this.maxFrames;(t=n[0])&&t.delay<=r&&(n.shift(),this.frame=t.delay,!(e=t.execute(t.state,t.delay))););if(e){for(;t=n.shift();)t.unsubscribe();throw e}},t.frameTimeFactor=10}(Oe);var qe=function(e){function t(t,n,r){void 0===r&&(r=t.index+=1);var i=e.call(this,t,n)||this;return i.scheduler=t,i.work=n,i.index=r,i.active=!0,i.index=t.index=r,i}return n(t,e),t.prototype.schedule=function(n,r){if(void 0===r&&(r=0),Number.isFinite(r)){if(!this.id)return e.prototype.schedule.call(this,n,r);this.active=!1;var i=new t(this.scheduler,this.work);return this.add(i),i.schedule(n,r)}return N.EMPTY},t.prototype.requestAsyncId=function(e,n,r){void 0===r&&(r=0),this.delay=e.frame+r;var i=e.actions;return i.push(this),i.sort(t.sortActions),1},t.prototype.recycleAsyncId=function(e,t,n){},t.prototype._execute=function(t,n){if(!0===this.active)return e.prototype._execute.call(this,t,n)},t.sortActions=function(e,t){return e.delay===t.delay?e.index===t.index?0:e.index>t.index?1:-1:e.delay>t.delay?1:-1},t}(we),De=new re((function(e){return e.complete()}));function Ne(e){return e&&j(e.schedule)}function Ue(e){return e[e.length-1]}function ze(e){return Ne(Ue(e))?e.pop():void 0}var We=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function Ye(e){return j(null==e?void 0:e.then)}function He(e){return j(e[te])}function Ve(e){return Symbol.asyncIterator&&j(null==e?void 0:e[Symbol.asyncIterator])}function Be(e){return new TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var Ge,Ke="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function Xe(e){return j(null==e?void 0:e[Ke])}function Ze(e){return a(this,arguments,(function(){var t,n,r;return o(this,(function(i){switch(i.label){case 0:t=e.getReader(),i.label=1;case 1:i.trys.push([1,,9,10]),i.label=2;case 2:return[4,s(t.read())];case 3:return n=i.sent(),r=n.value,n.done?[4,s(void 0)]:[3,5];case 4:return[2,i.sent()];case 5:return[4,s(r)];case 6:return[4,i.sent()];case 7:return i.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}function Je(e){return j(null==e?void 0:e.getReader)}function Qe(e){if(e instanceof re)return e;if(null!=e){if(He(e))return i=e,new re((function(e){var t=i[te]();if(j(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")}));if(We(e))return r=e,new re((function(e){for(var t=0;t<r.length&&!e.closed;t++)e.next(r[t]);e.complete()}));if(Ye(e))return n=e,new re((function(e){n.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,V)}));if(Ve(e))return $e(e);if(Xe(e))return t=e,new re((function(e){var n,r;try{for(var i=u(t),o=i.next();!o.done;o=i.next()){var c=o.value;if(e.next(c),e.closed)return}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}e.complete()}));if(Je(e))return $e(Ze(e))}var t,n,r,i;throw Be(e)}function $e(e){return new re((function(t){(function(e,t){var n,r,u,c;return i(this,void 0,void 0,(function(){var i,l;return o(this,(function(o){switch(o.label){case 0:o.trys.push([0,5,6,11]),n=d(e),o.label=1;case 1:return[4,n.next()];case 2:if((r=o.sent()).done)return[3,4];if(i=r.value,t.next(i),t.closed)return[2];o.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return l=o.sent(),u={error:l},[3,11];case 6:return o.trys.push([6,,9,10]),r&&!r.done&&(c=n.return)?[4,c.call(n)]:[3,8];case 7:o.sent(),o.label=8;case 8:return[3,10];case 9:if(u)throw u.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}}))}))})(e,t).catch((function(e){return t.error(e)}))}))}function et(e,t,n,r,i){void 0===r&&(r=0),void 0===i&&(i=!1);var o=t.schedule((function(){n(),i?e.add(this.schedule(null,r)):this.unsubscribe()}),r);if(e.add(o),!i)return o}function tt(e,t){return void 0===t&&(t=0),ue((function(n,r){n.subscribe(ce(r,(function(n){return et(r,e,(function(){return r.next(n)}),t)}),(function(){return et(r,e,(function(){return r.complete()}),t)}),(function(n){return et(r,e,(function(){return r.error(n)}),t)})))}))}function nt(e,t){return void 0===t&&(t=0),ue((function(n,r){r.add(e.schedule((function(){return n.subscribe(r)}),t))}))}function rt(e,t){if(!e)throw new Error("Iterable cannot be null");return new re((function(n){et(n,t,(function(){var r=e[Symbol.asyncIterator]();et(n,t,(function(){r.next().then((function(e){e.done?n.complete():n.next(e.value)}))}),0,!0)}))}))}function it(e,t){if(null!=e){if(He(e))return function(e,t){return Qe(e).pipe(nt(t),tt(t))}(e,t);if(We(e))return function(e,t){return new re((function(n){var r=0;return t.schedule((function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())}))}))}(e,t);if(Ye(e))return function(e,t){return Qe(e).pipe(nt(t),tt(t))}(e,t);if(Ve(e))return rt(e,t);if(Xe(e))return function(e,t){return new re((function(n){var r;return et(n,t,(function(){r=e[Ke](),et(n,t,(function(){var e,t,i;try{t=(e=r.next()).value,i=e.done}catch(e){return void n.error(e)}i?n.complete():n.next(t)}),0,!0)})),function(){return j(null==r?void 0:r.return)&&r.return()}}))}(e,t);if(Je(e))return function(e,t){return rt(Ze(e),t)}(e,t)}throw Be(e)}function ot(e,t){return t?it(e,t):Qe(e)}function ut(e){return e instanceof Date&&!isNaN(e)}!function(e){e.NEXT="N",e.ERROR="E",e.COMPLETE="C"}(Ge||(Ge={})),F((function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}})),F((function(e){return function(){e(this),this.name="ArgumentOutOfRangeError",this.message="argument out of range"}})),F((function(e){return function(t){e(this),this.name="NotFoundError",this.message=t}})),F((function(e){return function(t){e(this),this.name="SequenceError",this.message=t}}));var ct=F((function(e){return function(t){void 0===t&&(t=null),e(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=t}}));function lt(e){throw new ct(e)}function st(e,t){return ue((function(n,r){var i=0;n.subscribe(ce(r,(function(n){r.next(e.call(t,n,i++))})))}))}var at=Array.isArray;function dt(e){return st((function(t){return function(e,t){return at(t)?e.apply(void 0,l([],c(t))):e(t)}(e,t)}))}function ft(e,t,n){return void 0===n&&(n=1/0),j(t)?ft((function(n,r){return st((function(e,i){return t(n,e,r,i)}))(Qe(e(n,r)))}),n):("number"==typeof t&&(n=t),ue((function(t,r){return function(e,t,n,r,i,o,u,c){var l=[],s=0,a=0,d=!1,f=function(){!d||l.length||s||t.complete()},v=function(e){return s<r?h(e):l.push(e)},h=function(e){o&&t.next(e),s++;var c=!1;Qe(n(e,a++)).subscribe(ce(t,(function(e){null==i||i(e),o?v(e):t.next(e)}),(function(){c=!0}),void 0,(function(){if(c)try{s--;for(var e=function(){var e=l.shift();u?et(t,u,(function(){return h(e)})):h(e)};l.length&&s<r;)e();f()}catch(e){t.error(e)}})))};return e.subscribe(ce(t,v,(function(){d=!0,f()}))),function(){null==c||c()}}(t,r,e,n)})))}function vt(e){return void 0===e&&(e=1/0),ft(ne,e)}function ht(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return vt(1)(ot(e,ze(e)))}var pt=["addListener","removeListener"],yt=["addEventListener","removeEventListener"],bt=["on","off"];function mt(e,t,n,r){if(j(n)&&(r=n,n=void 0),r)return mt(e,t,n).pipe(dt(r));var i=c(function(e){return j(e.addEventListener)&&j(e.removeEventListener)}(e)?yt.map((function(r){return function(i){return e[r](t,i,n)}})):function(e){return j(e.addListener)&&j(e.removeListener)}(e)?pt.map(gt(e,t)):function(e){return j(e.on)&&j(e.off)}(e)?bt.map(gt(e,t)):[],2),o=i[0],u=i[1];if(!o&&We(e))return ft((function(e){return mt(e,t,n)}))(Qe(e));if(!o)throw new TypeError("Invalid event target");return new re((function(e){var t=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.next(1<t.length?t:t[0])};return o(t),function(){return u(t)}}))}function gt(e,t){return function(n){return function(r){return e[n](t,r)}}}function wt(e,t,n){void 0===e&&(e=0),void 0===n&&(n=Me);var r=-1;return null!=t&&(Ne(t)?n=t:r=t),new re((function(t){var i=ut(e)?+e-n.now():e;i<0&&(i=0);var o=0;return n.schedule((function(){t.closed||(t.next(o++),0<=r?this.schedule(void 0,r):t.complete())}),i)}))}function xt(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=ze(e),r=function(e,t){return"number"==typeof Ue(e)?e.pop():t}(e,1/0),i=e;return i.length?1===i.length?Qe(i[0]):vt(r)(ot(i,n)):De}new re(B);var _t=Array.isArray;function Et(e,t){return ue((function(n,r){var i=0;n.subscribe(ce(r,(function(n){return e.call(t,n,i++)&&r.next(n)})))}))}function At(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return 1===(t=1===(e=t).length&&_t(e[0])?e[0]:e).length?Qe(t[0]):new re(function(e){return function(t){for(var n=[],r=function(r){n.push(Qe(e[r]).subscribe(ce(t,(function(e){if(n){for(var i=0;i<n.length;i++)i!==r&&n[i].unsubscribe();n=null}t.next(e)}))))},i=0;n&&!t.closed&&i<e.length;i++)r(i)}}(t))}function St(e){return e<=0?function(){return De}:ue((function(t,n){var r=0;t.subscribe(ce(n,(function(t){++r<=e&&(n.next(t),e<=r&&n.complete())})))}))}function Tt(e,t){return t?function(n){return ht(t.pipe(St(1),ue((function(e,t){e.subscribe(ce(t,B))}))),n.pipe(Tt(e)))}:ft((function(t,n){return Qe(e(t,n)).pipe(St(1),function(e){return st((function(){return e}))}(t))}))}function kt(e){void 0===e&&(e={});var t=e.connector,n=void 0===t?function(){return new ve}:t,r=e.resetOnError,i=void 0===r||r,o=e.resetOnComplete,u=void 0===o||o,c=e.resetOnRefCountZero,l=void 0===c||c;return function(e){var t,r,o,c=0,s=!1,a=!1,d=function(){null==r||r.unsubscribe(),r=void 0},f=function(){d(),t=o=void 0,s=a=!1},v=function(){var e=t;f(),null==e||e.unsubscribe()};return ue((function(e,h){c++,a||s||d();var p=o=null!=o?o:n();h.add((function(){0!==--c||a||s||(r=Ct(v,l))})),p.subscribe(h),!t&&c>0&&(t=new Q({next:function(e){return p.next(e)},error:function(e){a=!0,d(),r=Ct(f,i,e),p.error(e)},complete:function(){s=!0,d(),r=Ct(f,u),p.complete()}}),Qe(e).subscribe(t))}))(e)}}function Ct(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!0!==t){if(!1!==t){var i=new Q({next:function(){i.unsubscribe(),e()}});return Qe(t.apply(void 0,l([],c(n)))).subscribe(i)}}else e()}function Ot(e,t,n){void 0===t&&(t=Ie);var r=wt(e,t);return function(e,t){return ue((function(n,r){var i=null!=t?t:{},o=i.leading,u=void 0===o||o,c=i.trailing,l=void 0!==c&&c,s=!1,a=null,d=null,f=!1,v=function(){null==d||d.unsubscribe(),d=null,l&&(y(),f&&r.complete())},h=function(){d=null,f&&r.complete()},p=function(t){return d=Qe(e(t)).subscribe(ce(r,v,h))},y=function(){if(s){s=!1;var e=a;a=null,r.next(e),!f&&p(e)}};n.subscribe(ce(r,(function(e){s=!0,a=e,(!d||d.closed)&&(u?y():p(e))}),(function(){f=!0,(!(l&&s&&d)||d.closed)&&r.complete()})))}))}((function(){return r}),n)}var Pt=["input","select","textarea"],It=function(e,t){var n,r=null===(n=null===window||void 0===window?void 0:window.getComputedStyle)||void 0===n?void 0:n.call(window,e);return"pointer"===(null==r?void 0:r.getPropertyValue("cursor"))&&"click"===t},Mt=function(e,t,n){return void 0===n&&(n=!1),function(r,i){var o,u,c=e.pageUrlAllowlist,l=e.pageUrlExcludelist,s=e.shouldTrackEventResolver,a=null===(u=null===(o=null==i?void 0:i.tagName)||void 0===o?void 0:o.toLowerCase)||void 0===u?void 0:u.call(o);if(!a)return!1;if(s)return s(r,i);if(!h(window.location.href,c))return!1;if(l&&l.length>0&&h(window.location.href,l))return!1;var d=String(null==i?void 0:i.getAttribute("type"))||"";if("string"==typeof d)switch(d.toLowerCase()){case"hidden":case"password":return!1}var f=It(i,r);if(n&&f)return!0;if(t){var v=t.some((function(e){var t;return!!(null===(t=null==i?void 0:i.matches)||void 0===t?void 0:t.call(i,e))}));if(!v)return!1}switch(a){case"input":case"select":case"textarea":return"change"===r||"click"===r;default:return!!f||"click"===r}}},Rt=function(e){return Object.keys(e).reduce((function(t,n){var r=e[n];return function(e){return null==e||"object"==typeof e&&0===Object.keys(e).length||"string"==typeof e&&0===e.trim().length}(r)||(t[n]=r),t}),{})},Lt=function(e,t){return e?t.some((function(t){var n;return null===(n=null==e?void 0:e.matches)||void 0===n?void 0:n.call(e,t)}))?e:Lt(null==e?void 0:e.parentElement,t):null};var jt=function(e){return!(null===e.event.target||!e.closestTrackedAncestor)};var Ft=new Set(["id","class","style","value","onclick","onchange","oninput","onblur","onsubmit","onfocus","onkeydown","onkeyup","onkeypress","data-reactid","data-react-checksum","data-reactroot",M,R]),qt=["type"],Dt=["svg","path","g"],Nt=["password","hidden"];function Ut(e,t){var n,r,i,o,c,l;if(null===e)return null;var s=String(e.tagName).toLowerCase(),a={tag:s},d=Array.from(null!==(o=null===(i=e.parentElement)||void 0===i?void 0:i.children)&&void 0!==o?o:[]);d.length&&(a.index=d.indexOf(e),a.indexOfType=d.filter((function(t){return t.tagName===e.tagName})).indexOf(e));var f=null===(l=null===(c=e.previousElementSibling)||void 0===c?void 0:c.tagName)||void 0===l?void 0:l.toLowerCase();f&&(a.prevSib=String(f));var v=e.getAttribute("id");v&&(a.id=String(v));var h=Array.from(e.classList);h.length&&(a.classes=h);var p={},y=Array.from(e.attributes).filter((function(e){return!Ft.has(e.name)})),b=!function(e){var t,n,r,i=null===(n=null===(t=null==e?void 0:e.tagName)||void 0===t?void 0:t.toLowerCase)||void 0===n?void 0:n.call(t),o=e instanceof HTMLElement&&"true"===(null===(r=e.getAttribute("contenteditable"))||void 0===r?void 0:r.toLowerCase());return!Pt.includes(i)&&!o}(e);if(!Nt.includes(String(e.getAttribute("type")))&&!Dt.includes(s))try{for(var m=u(y),g=m.next();!g.done;g=m.next()){var w=g.value;b&&!qt.includes(w.name)||(t.has(w.name)?p[w.name]=L:p[w.name]=String(w.value).substring(0,128))}}catch(e){n={error:e}}finally{try{g&&!g.done&&(r=m.return)&&r.call(m)}finally{if(n)throw n.error}}return Object.keys(p).length&&(a.attrs=p),a}var zt=function(e,t,n){e.forEach((function(e){if("string"!=typeof e&&"ATTACH_EVENT_PROPERTY"===e.actionType){var r=n.extractDataFromDataSource(e.dataSource,t.closestTrackedAncestor);t.targetElementProperties[e.destinationKey]=r}}))},Wt=/\b(?:\d[ -]*?){13,16}\b/,Yt=/(\d{3}-?\d{2}-?\d{4})/g,Ht=/[^\s@]+@[^\s@.]+\.[^\s@]+/g,Vt=function(e){var t,n,r,i=this;this.replaceSensitiveString=function(e){var t,n;if("string"!=typeof e)return"";var r=e;r=(r=(r=r.replace(Wt,L)).replace(Yt,L)).replace(Ht,L);try{for(var o=u(i.additionalMaskTextPatterns),c=o.next();!c.done;c=o.next()){var l=c.value;try{r=r.replace(l,L)}catch(e){}}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return r},this.getHierarchy=function(e){var t,n,r,o;if(!e)return[];for(var s,a=function(e){var t=[];if(!e)return t;t.push(e);for(var n=e.parentElement;n&&"HTML"!==n.tagName;)t.push(n),n=n.parentElement;return t}(e),d=new Map,f=a.length-1;f>=0;f--){var v=a[f];if(v){var h=(s=v.getAttribute(M))?s.split(",").map((function(e){return e.trim()})).filter((function(e){return e.length>0&&"id"!==e&&"class"!==e})):[],p=f===a.length-1?[]:null!==(r=d.get(a[f+1]))&&void 0!==r?r:new Set,y=new Set(l(l([],c(p),!1),c(h),!1));d.set(v,y)}}o=a.map((function(e){var t;return Ut(e,null!==(t=d.get(e))&&void 0!==t?t:new Set)}));var b=function(e){(null==e?void 0:e.attrs)&&Object.entries(e.attrs).forEach((function(t){var n=c(t,2),r=n[0],o=n[1];e.attrs&&(e.attrs[r]=i.replaceSensitiveString(o))}))};try{for(var m=u(o),g=m.next();!g.done;g=m.next())b(g.value)}catch(e){t={error:e}}finally{try{g&&!g.done&&(n=m.return)&&n.call(m)}finally{if(t)throw t.error}}return o},this.getNearestLabel=function(e){var t,n=e.parentElement;if(!n)return"";try{t=n.querySelector(":scope>span,h1,h2,h3,h4,h5,h6")}catch(e){t=null}return t?i.getText(t):i.getNearestLabel(n)},this.getEventProperties=function(e,t,n){var r,o,u,l,s,a,d=null===(u=null===(o=null==t?void 0:t.tagName)||void 0===o?void 0:o.toLowerCase)||void 0===u?void 0:u.call(o),f="function"==typeof t.getBoundingClientRect?t.getBoundingClientRect():{left:null,top:null},v=i.getHierarchy(t),h=null===(l=v[0])||void 0===l?void 0:l.attrs,p=i.getNearestLabel(t),y=(s=null!=h?h:{},a=n,Object.entries(s).reduce((function(e,t){var n=c(t,2),r=n[0],i=n[1];if(r.startsWith(a)){var o=r.replace(a,"");o&&(e[o]=i||"")}return e}),{})),b=((r={})["[Amplitude] Element Hierarchy"]=v,r[k]=d,r[C]=i.getText(t),r["[Amplitude] Element Position Left"]=null==f.left?null:Math.round(f.left),r["[Amplitude] Element Position Top"]=null==f.top?null:Math.round(f.top),r["[Amplitude] Element Attributes"]=y,r["[Amplitude] Element Parent Label"]=p,r[O]=window.location.href.split("?")[0],r["[Amplitude] Page Title"]="undefined"!=typeof document&&i.replaceSensitiveString(document.title)||"",r["[Amplitude] Viewport Height"]=window.innerHeight,r["[Amplitude] Viewport Width"]=window.innerWidth,r);return b["[Amplitude] Element ID"]=t.getAttribute("id")||"",b["[Amplitude] Element Class"]=t.getAttribute("class"),b["[Amplitude] Element Aria Label"]=null==h?void 0:h["aria-label"],"a"===d&&"click"===e&&t instanceof HTMLAnchorElement&&(b["[Amplitude] Element Href"]=i.replaceSensitiveString(t.href)),Rt(b)},this.addAdditionalEventProperties=function(e,t,n,r,o){void 0===o&&(o=!1);var u={event:e,timestamp:Date.now(),type:t};if(function(e){return"click"===e.type||"change"===e.type}(u)&&null!==u.event.target){if(o&&It(u.event.target,u.type))return u.closestTrackedAncestor=u.event.target,u.targetElementProperties=i.getEventProperties(u.type,u.closestTrackedAncestor,r),u;var c=Lt(u.event.target,n);return c&&(u.closestTrackedAncestor=c,u.targetElementProperties=i.getEventProperties(u.type,c,r)),u}return u},this.extractDataFromDataSource=function(e,t){if("DOM_ELEMENT"===e.sourceType){var n=function(e,t){try{if("DOM_ELEMENT"===e.sourceType){var n=document.documentElement;return e.scope&&t&&(n=t.closest(e.scope)),n&&e.selector?n.querySelector(e.selector):n}}catch(e){return}}(e,t);if(!n)return;return"TEXT"===e.elementExtractType?i.getText(n):"ATTRIBUTE"===e.elementExtractType&&e.attribute?n.getAttribute(e.attribute):void 0}},this.getText=function(e){if(null!==e.closest("[".concat(R,"]")))return L;var t="";if(e.querySelector("[".concat(R,"], [contenteditable]"))){var n=e.cloneNode(!0);n.querySelectorAll("[".concat(R,"], [contenteditable]")).forEach((function(e){e.innerText=L})),t=n.innerText||""}else t=e.innerText||"";return i.replaceSensitiveString(t.substring(0,255)).replace(/\s+/g," ").trim()},this.getEventTagProps=function(e){var t,n,r;if(!e)return{};var o=null===(r=null===(n=null==e?void 0:e.tagName)||void 0===n?void 0:n.toLowerCase)||void 0===r?void 0:r.call(n),u=((t={})[k]=o,t[C]=i.getText(e),t[O]=window.location.href.split("?")[0],t);return Rt(u)};var o=null!==(r=e.maskTextRegex)&&void 0!==r?r:[],s=[];try{for(var a=u(o),d=a.next();!d.done;d=a.next()){var f=d.value;if(s.length>=25)break;if(f instanceof RegExp)s.push(f);else if("pattern"in f&&"string"==typeof f.pattern)try{s.push(new RegExp(f.pattern,"i"))}catch(e){}}}catch(e){t={error:e}}finally{try{d&&!d.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}this.additionalMaskTextPatterns=s},Bt=function(){function e(e){var t=(void 0===e?{}:e).origin,n=void 0===t?P:t,r=this;this.endpoint=P,this.requestCallbacks={},this.onSelect=function(e){r.notify({action:"element-selected",data:e})},this.onTrack=function(e,t){"selector-mode-changed"===e?r.notify({action:"track-selector-mode-changed",data:t}):"selector-moved"===e&&r.notify({action:"track-selector-moved",data:t})},this.endpoint=n}return e.prototype.notify=function(e){var t,n,r,i;null===(n=null===(t=this.logger)||void 0===t?void 0:t.debug)||void 0===n||n.call(t,"Message sent: ",JSON.stringify(e)),null===(i=null===(r=window.opener)||void 0===r?void 0:r.postMessage)||void 0===i||i.call(r,e,this.endpoint)},e.prototype.sendRequest=function(e,t,n){var r=this;void 0===n&&(n={timeout:15e3});var i="".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),o={id:i,action:e,args:t};return new Promise((function(t,u){r.requestCallbacks[i]={resolve:t,reject:u},r.notify(o),(null==n?void 0:n.timeout)>0&&setTimeout((function(){u(new Error("".concat(e," timed out (id: ").concat(i,")"))),delete r.requestCallbacks[i]}),n.timeout)}))},e.prototype.handleResponse=function(e){var t;this.requestCallbacks[e.id]?(this.requestCallbacks[e.id].resolve(e.responseData),delete this.requestCallbacks[e.id]):null===(t=this.logger)||void 0===t||t.warn("No callback found for request id: ".concat(e.id))},e.prototype.setup=function(e){var t=this,n=void 0===e?{dataExtractor:new Vt({})}:e,r=n.logger,i=n.endpoint,o=n.isElementSelectable,u=n.cssSelectorAllowlist,c=n.actionClickAllowlist,l=n.dataExtractor;this.logger=r,i&&this.endpoint===P&&(this.endpoint=i);var s=null;window.addEventListener("message",(function(e){var n,r,i,a,d;if(null===(r=null===(n=t.logger)||void 0===n?void 0:n.debug)||void 0===r||r.call(n,"Message received: ",JSON.stringify(e)),t.endpoint===e.origin){var f,v=null==e?void 0:e.data,h=null==v?void 0:v.action;if(h)if("id"in v)null===(a=null===(i=t.logger)||void 0===i?void 0:i.debug)||void 0===a||a.call(i,"Received Response to previous request: ",JSON.stringify(e)),t.handleResponse(v);else if("ping"===h)t.notify({action:"pong"});else if("initialize-visual-tagging-selector"===h){var p=null==v?void 0:v.data;(f="https://cdn.amplitude.com/libs/visual-tagging-selector-1.0.0-alpha.js.gz",new Promise((function(e,t){var n;try{var r=document.createElement("script");r.type="text/javascript",r.async=!0,r.src=f,r.addEventListener("load",(function(){e({status:!0})}),{once:!0}),r.addEventListener("error",(function(){t({status:!1,message:"Failed to load the script ".concat(f)})})),null===(n=document.head)||void 0===n||n.appendChild(r)}catch(e){t(e)}}))).then((function(){var e;s=null===(e=null===window||void 0===window?void 0:window.amplitudeVisualTaggingSelector)||void 0===e?void 0:e.call(window,{getEventTagProps:l.getEventTagProps,isElementSelectable:function(e){return!o||o((null==p?void 0:p.actionType)||"click",e)},onTrack:t.onTrack,onSelect:t.onSelect,visualHighlightClass:"amp-visual-tagging-selector-highlight",messenger:t,cssSelectorAllowlist:u,actionClickAllowlist:c,extractDataFromDataSource:l.extractDataFromDataSource,dataExtractor:l,diagnostics:{autocapture:{version:"1.12.1"}}}),t.notify({action:"selector-loaded"})})).catch((function(){var e;null===(e=t.logger)||void 0===e||e.warn("Failed to initialize visual tagging selector")}))}else"close-visual-tagging-selector"===h&&(null===(d=null==s?void 0:s.close)||void 0===d||d.call(s))}})),this.notify({action:"page-loaded"})},e}();function Gt(e){var t,n,r,i=e.amplitude,o=e.allObservables,l=e.options,s=e.shouldTrackEvent,a=e.evaluateTriggers,d=o.clickObservable,f=d.pipe(ue((function(e,t){var n,r=!1;e.subscribe(ce(t,(function(e){var i=n;n=e,r&&t.next([i,e]),r=!0})))})),Et((function(e){var t=c(e,2),n=t[0],r=t[1],i=n.event.target!==r.event.target,o=Math.abs(r.event.screenX-n.event.screenX)<=20&&Math.abs(r.event.screenY-n.event.screenY)<=20;return i&&!o}))),v=xt(f,d.pipe((t=l.debounceTime,void 0===n&&(n=Ie),ue((function(e,r){var i=null,o=null,u=null,c=function(){if(i){i.unsubscribe(),i=null;var e=o;o=null,r.next(e)}};function l(){var e=u+t,o=n.now();if(o<e)return i=this.schedule(void 0,e-o),void r.add(i);c()}e.subscribe(ce(r,(function(e){o=e,u=n.now(),i||(i=n.schedule(l,t),r.add(i))}),(function(){c(),r.complete()}),void 0,(function(){o=i=null})))}))),st((function(){return"timeout"})))),h=d.pipe(function(e,t){void 0===t&&(t=Ie);var n=wt(e,t);return Tt((function(){return n}))}(0),Et(jt),Et((function(e){return s("click",e.closestTrackedAncestor)})),st((function(e){return a(e)})),(r=v,ue((function(e,t){var n=[];return e.subscribe(ce(t,(function(e){return n.push(e)}),(function(){t.next(n),t.complete()}))),Qe(r).subscribe(ce(t,(function(){var e=n;n=[],t.next(e)}),B)),function(){n=null}}))));return h.subscribe((function(e){var t,n,r=(e.length,S);try{for(var o=u(e),c=o.next();!c.done;c=o.next()){var l=c.value;null==i||i.track(r,l.targetElementProperties)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}}))}function Kt(e){var t=e.amplitude,n=e.allObservables,r=e.options,i=e.getEventProperties,o=e.shouldTrackEvent,u=e.shouldTrackActionClick,s=n.clickObservable,a=n.mutationObservable,d=n.navigateObservable,f=s.pipe(Et((function(e){return!o("click",e.closestTrackedAncestor)})),st((function(e){var t=Lt(e.event.target,r.actionClickAllowlist);return e.closestTrackedAncestor=t,null!==e.closestTrackedAncestor&&(e.targetElementProperties=i(e.type,e.closestTrackedAncestor)),e})),Et(jt),Et((function(e){return u("click",e.closestTrackedAncestor)}))),v=[a];d&&v.push(d);var h,p,y=xt.apply(void 0,l([],c(v),!1)),b=f.pipe((h=function(e){return y.pipe(St(1),function(e,t){var n=ut(e)?{first:e}:"number"==typeof e?{each:e}:e,r=n.first,i=n.each,o=n.with,u=void 0===o?lt:o,c=n.scheduler,l=void 0===c?null!=t?t:Ie:c,s=n.meta,a=void 0===s?null:s;if(null==r&&null==i)throw new TypeError("No timeout provided.");return ue((function(e,t){var n,o,c=null,s=0,d=function(e){o=et(t,l,(function(){try{n.unsubscribe(),Qe(u({meta:a,lastValue:c,seen:s})).subscribe(t)}catch(e){t.error(e)}}),e)};n=e.subscribe(ce(t,(function(e){null==o||o.unsubscribe(),s++,t.next(c=e),i>0&&d(i)}),void 0,void 0,(function(){(null==o?void 0:o.closed)||null==o||o.unsubscribe(),c=null}))),!s&&d(null!=r?"number"==typeof r?r:+r-l.now():i)}))}({first:500,with:function(){return De}}),st((function(){return e})))},ue((function(e,t){var n=null,r=0,i=!1,o=function(){return i&&!n&&t.complete()};e.subscribe(ce(t,(function(e){null==n||n.unsubscribe();var i=0,u=r++;Qe(h(e,u)).subscribe(n=ce(t,(function(n){return t.next(p?p(e,n,u,i++):n)}),(function(){n=null,o()})))}),(function(){i=!0,o()})))}))));return b.subscribe((function(e){null==t||t.track(S,i("click",e.closestTrackedAncestor))}))}var Xt,Zt=function(){return new re((function(e){var t=new MutationObserver((function(t){e.next(t)}));return t.observe(document.body,{childList:!0,attributes:!0,characterData:!0,subtree:!0}),function(){return t.disconnect()}}))},Jt=function(e){return void 0===e&&(e="click"),mt(document,e,{capture:!0})},Qt={"[Amplitude] Element Clicked":"click","[Amplitude] Element Changed":"change"},$t=function(e){var t,n,r,i,o=Object.values(Qt).reduce((function(e,t){return e[t]=new Set,e}),{});if(!e)return o;try{for(var c=u(e),l=c.next();!l.done;l=c.next()){var s=l.value;try{try{for(var a=(r=void 0,u(s.definition)),d=a.next();!d.done;d=a.next()){var f=d.value,v=Qt[f.event_type];v&&o[v].add(s.id)}}catch(e){r={error:e}}finally{try{d&&!d.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}}catch(e){console.warn("Skipping Labeled Event due to malformed definition",null==s?void 0:s.id,e)}}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return o},en=function(e){var t,n,r,i,o=new Map;try{for(var c=u(e),l=c.next();!l.done;l=c.next()){var s=l.value;try{for(var a=(r=void 0,u(s.conditions)),d=a.next();!d.done;d=a.next()){var f=d.value;if("LABELED_EVENT"===f.type){var v=f.match.eventId,h=o.get(v);h||(h=[],o.set(v,h)),h.push(s)}}}catch(e){r={error:e}}finally{try{d&&!d.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return o},tn=function(e,t){return t.filter((function(t){return t.definition.some((function(t){return Qt[t.event_type]===e.type&&t.filters.every((function(t){return function(e,t){try{if("[Amplitude] Element Text"===t.subprop_key)return"is"===t.subprop_op&&t.subprop_value.includes(e.targetElementProperties["[Amplitude] Element Text"]);if("[Amplitude] Element Hierarchy"===t.subprop_key)return"autotrack css match"===t.subprop_op&&!!e.closestTrackedAncestor.closest(t.subprop_value.toString())}catch(e){return console.error("Error matching event to filter",e),!1}return!1}(e,t)}))}))}))},nn=function(){function e(e,t,n,r){this.groupedLabeledEvents=e,this.labeledEventToTriggerMap=t,this.dataExtractor=n,this.options=r}return e.prototype.evaluate=function(e){var t,n,r=this.options.pageActions;if(!r)return e;var i=function(e,t){var n,r,i,o,c=new Set;try{for(var l=u(e),s=l.next();!s.done;s=l.next()){var a=s.value,d=t.get(a.id);if(d)try{for(var f=(i=void 0,u(d)),v=f.next();!v.done;v=f.next()){var h=v.value;c.add(h)}}catch(e){i={error:e}}finally{try{v&&!v.done&&(o=f.return)&&o.call(f)}finally{if(i)throw i.error}}}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}return Array.from(c)}(tn(e,Array.from(this.groupedLabeledEvents[e.type]).map((function(e){return r.labeledEvents[e]}))),this.labeledEventToTriggerMap);try{for(var o=u(i),c=o.next();!c.done;c=o.next()){var l=c.value;zt(l.actions,e,this.dataExtractor)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return e},e.prototype.update=function(e,t,n){this.groupedLabeledEvents=e,this.labeledEventToTriggerMap=t,this.options=n},e}();!function(e){e.ClickObservable="clickObservable",e.ChangeObservable="changeObservable",e.NavigateObservable="navigateObservable",e.MutationObservable="mutationObservable"}(Xt||(Xt={}));var rn=function(e){var t,n,s,a,d,f,v,h;void 0===e&&(e={});var m=e.dataAttributePrefix,g=void 0===m?y:m,w=e.visualTaggingOptions,x=void 0===w?{enabled:!0,messenger:new Bt}:w;e.cssSelectorAllowlist=null!==(t=e.cssSelectorAllowlist)&&void 0!==t?t:p,e.actionClickAllowlist=null!==(n=e.actionClickAllowlist)&&void 0!==n?n:b,e.debounceTime=null!==(s=e.debounceTime)&&void 0!==s?s:0,e.pageUrlExcludelist=null===(a=e.pageUrlExcludelist)||void 0===a?void 0:a.reduce((function(e,t){if("string"==typeof t&&e.push(t),t instanceof RegExp&&e.push(t),"object"==typeof t&&null!==t&&"pattern"in t)try{e.push(new RegExp(t.pattern))}catch(n){return console.warn("Invalid regex pattern: ".concat(t.pattern),n),e}return e}),[]);var _="@amplitude/plugin-autocapture-browser",E=[],S=new Vt(e),T=$t(Object.values(null!==(f=null===(d=e.pageActions)||void 0===d?void 0:d.labeledEvents)&&void 0!==f?f:{})),k=en(null!==(h=null===(v=e.pageActions)||void 0===v?void 0:v.triggers)&&void 0!==h?h:[]),C=function(e,t,n,r){return new nn(e,t,n,r)}(T,k,S,e);return{name:_,type:"enrichment",setup:function(t,n){return i(void 0,void 0,void 0,(function(){var u,s,a,d,f,v,h,p,y,b;return o(this,(function(m){return"undefined"==typeof document||(t.fetchRemoteConfig&&A({localConfig:t,configKeys:["analyticsSDK.pageActions"]}).then((function(n){return i(void 0,void 0,void 0,(function(){var i,u;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,n.getRemoteConfig("analyticsSDK","pageActions")];case 1:return function(t){var n,i;t&&(e.pageActions=r(r({},e.pageActions),t),T=$t(Object.values(null!==(n=e.pageActions.labeledEvents)&&void 0!==n?n:{})),k=en(null!==(i=e.pageActions.triggers)&&void 0!==i?i:[]),C.update(T,k,e))}(o.sent()),[3,3];case 2:return i=o.sent(),null===(u=null==t?void 0:t.loggerProvider)||void 0===u||u.error("Failed to fetch remote config: ".concat(String(i))),[3,3];case 3:return[2]}}))}))})).catch((function(e){var n;null===(n=null==t?void 0:t.loggerProvider)||void 0===n||n.error("Failed to create remote config fetch: ".concat(String(e)))})),u=Mt(e,e.cssSelectorAllowlist),s=Mt(e,e.actionClickAllowlist),a=function(){var t,n,r=Jt().pipe(st((function(t){return S.addAdditionalEventProperties(t,"click",e.cssSelectorAllowlist,g)})),kt()),i=mt(document,"change",{capture:!0}).pipe(st((function(t){return S.addAdditionalEventProperties(t,"change",e.cssSelectorAllowlist,g)})),kt());window.navigation&&(n=mt(window.navigation,"navigate").pipe(st((function(t){return S.addAdditionalEventProperties(t,"navigate",e.cssSelectorAllowlist,g)})),kt()));var o=Zt().pipe(st((function(t){return S.addAdditionalEventProperties(t,"mutation",e.cssSelectorAllowlist,g)})),kt());return(t={})[Xt.ClickObservable]=r,t[Xt.ChangeObservable]=i,t[Xt.NavigateObservable]=n,t[Xt.MutationObservable]=o,t}(),d=Gt({allObservables:a,options:e,amplitude:n,shouldTrackEvent:u,evaluateTriggers:C.evaluate.bind(C)}),E.push(d),f=function(e){var t=e.amplitude,n=e.allObservables,r=e.getEventProperties,i=e.shouldTrackEvent,o=e.evaluateTriggers;return n.changeObservable.pipe(Et(jt),Et((function(e){return i("change",e.closestTrackedAncestor)})),st((function(e){return o(e)}))).subscribe((function(e){null==t||t.track("[Amplitude] Element Changed",r("change",e.closestTrackedAncestor))}))}({allObservables:a,getEventProperties:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return S.getEventProperties.apply(S,l(l([],c(e),!1),[g],!1))},amplitude:n,shouldTrackEvent:u,evaluateTriggers:C.evaluate.bind(C)}),E.push(f),v=Kt({allObservables:a,options:e,getEventProperties:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return S.getEventProperties.apply(S,l(l([],c(e),!1),[g],!1))},amplitude:n,shouldTrackEvent:u,shouldTrackActionClick:s}),E.push(v),null===(y=null==t?void 0:t.loggerProvider)||void 0===y||y.log("".concat(_," has been successfully added.")),window.opener&&x.enabled&&(h=e.cssSelectorAllowlist,p=e.actionClickAllowlist,null===(b=x.messenger)||void 0===b||b.setup(r(r({dataExtractor:S,logger:null==t?void 0:t.loggerProvider},(null==t?void 0:t.serverZone)&&{endpoint:I[t.serverZone]}),{isElementSelectable:Mt(e,l(l([],c(h),!1),c(p),!1)),cssSelectorAllowlist:h,actionClickAllowlist:p})))),[2]}))}))},execute:function(e){return i(void 0,void 0,void 0,(function(){return o(this,(function(t){return[2,e]}))}))},teardown:function(){return i(void 0,void 0,void 0,(function(){var e,t,n,r;return o(this,(function(i){try{for(e=u(E),t=e.next();!t.done;t=e.next())t.value.unsubscribe()}catch(e){n={error:e}}finally{try{t&&!t.done&&(r=e.return)&&r.call(e)}finally{if(n)throw n.error}}return[2]}))}))}}};function on(e,t){var n,r,i,o,u=t.event,c=u.clientX,l=u.clientY;e.yMin=Math.min(null!==(n=e.yMin)&&void 0!==n?n:l,l),e.yMax=Math.max(null!==(r=e.yMax)&&void 0!==r?r:l,l),e.xMin=Math.min(null!==(i=e.xMin)&&void 0!==i?i:c,c),e.xMax=Math.max(null!==(o=e.xMax)&&void 0!==o?o:c,c),e.isOutOfBounds=e.yMax-e.yMin>50||e.xMax-e.xMin>50}function un(e){var t=e[0],n=e[e.length-1];return{rageClickEvent:r({"[Amplitude] Begin Time":new Date(t.timestamp).toISOString(),"[Amplitude] End Time":new Date(n.timestamp).toISOString(),"[Amplitude] Duration":n.timestamp-t.timestamp,"[Amplitude] Clicks":e.map((function(e){return{X:e.event.clientX,Y:e.event.clientY,Time:e.timestamp}})),"[Amplitude] Click Count":e.length},t.targetElementProperties),time:t.timestamp}}function cn(e){var t,n=e.amplitude,r=e.allObservables,i=e.shouldTrackRageClick,o=r.clickObservable,u=[],c={};function l(e){u=[],c={},e&&(on(c,e),u.push(e))}return o.pipe(Et(jt),Et((function(e){return i("click",e.closestTrackedAncestor)})),st((function(e){if(t&&clearTimeout(t),on(c,e),0===u.length)return u.push(e),null;if(function(e,t){return e.length>0&&e[e.length-1].closestTrackedAncestor!==t.closestTrackedAncestor}(u,e)||function(e,t){var n=e[Math.max(0,e.length-4+1)];return t.timestamp-n.timestamp>=1e3}(u,e)||c.isOutOfBounds){var r=u.length>=4?un(u):null;return l(e),r}return u.push(e),u.length>=4&&(t=setTimeout((function(){var e=un(u),t=e.rageClickEvent,r=e.time;n.track(T,t,{time:r}),l()}),1e3)),null})),Et((function(e){return null!==e}))).subscribe((function(e){null!==e&&n.track(T,e.rageClickEvent,{time:e.time})}))}return e.DataExtractor=Vt,e.WindowMessenger=Bt,e.autocapturePlugin=rn,e.frustrationPlugin=function(e){var t,n,s,a,d;void 0===e&&(e={});var f="@amplitude/plugin-frustration-browser",v=[],h=null!==(n=null===(t=e.rageClicks)||void 0===t?void 0:t.cssSelectorAllowlist)&&void 0!==n?n:g,p=null!==(a=null===(s=e.deadClicks)||void 0===s?void 0:s.cssSelectorAllowlist)&&void 0!==a?a:m,b=null!==(d=e.dataAttributePrefix)&&void 0!==d?d:y,w=new Vt(e),x=l([],c(new Set(l(l([],c(h),!1),c(p),!1))),!1);return{name:f,type:"enrichment",setup:function(t,n){return i(void 0,void 0,void 0,(function(){var i,u,s,a,d,y;return o(this,(function(o){return"undefined"==typeof document||(i=Mt(e,h),u=Mt(e,p),s=function(){var e,t,n=Jt("pointerdown").pipe(st((function(e){return w.addAdditionalEventProperties(e,"click",x,b,!0)})),kt());window.navigation&&(t=mt(window.navigation,"navigate").pipe(st((function(e){return w.addAdditionalEventProperties(e,"navigate",x,b)})),kt()));var r=Zt().pipe(st((function(e){return w.addAdditionalEventProperties(e,"mutation",x,b)})),kt());return(e={})[Xt.ClickObservable]=n,e[Xt.ChangeObservable]=new re,e[Xt.NavigateObservable]=t,e[Xt.MutationObservable]=r,e}(),a=cn({allObservables:s,amplitude:n,shouldTrackRageClick:i}),v.push(a),d=function(e){var t=e.amplitude,n=e.allObservables,i=e.getEventProperties,o=e.shouldTrackDeadClick,u=n.clickObservable,s=n.mutationObservable,a=n.navigateObservable,d=u.pipe(Et(jt),Et((function(e){return o("click",e.closestTrackedAncestor)}))),f=[s];a&&f.push(a);var v=xt.apply(void 0,l([],c(f),!1));return d.pipe(ft((function(e){var t;return At(new re((function(n){return t=setTimeout((function(){return n.next(e)}),3e3),function(){clearTimeout(t)}})),v.pipe(St(1),st((function(){return null})))).pipe(Et((function(e){return null!==e})))})),Ot(3e3)).subscribe((function(e){var n={"[Amplitude] X":e.event.clientX,"[Amplitude] Y":e.event.clientY};t.track("[Amplitude] Dead Click",r(r({},i("click",e.closestTrackedAncestor)),n),{time:e.timestamp})}))}({amplitude:n,allObservables:s,getEventProperties:function(e,t){return w.getEventProperties(e,t,b)},shouldTrackDeadClick:u}),v.push(d),null===(y=null==t?void 0:t.loggerProvider)||void 0===y||y.log("".concat(f," has been successfully added."))),[2]}))}))},execute:function(e){return i(void 0,void 0,void 0,(function(){return o(this,(function(t){return[2,e]}))}))},teardown:function(){return i(void 0,void 0,void 0,(function(){var e,t,n,r;return o(this,(function(i){try{for(e=u(v),t=e.next();!t.done;t=e.next())t.value.unsubscribe()}catch(e){n={error:e}}finally{try{t&&!t.done&&(r=e.return)&&r.call(e)}finally{if(n)throw n.error}}return[2]}))}))}}},e.plugin=rn,Object.defineProperty(e,"__esModule",{value:!0}),e}({});
//# sourceMappingURL=amplitude-min.js.map
