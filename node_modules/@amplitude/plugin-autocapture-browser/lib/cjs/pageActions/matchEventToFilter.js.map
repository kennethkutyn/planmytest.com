{"version":3,"file":"matchEventToFilter.js","sourceRoot":"","sources":["../../../src/pageActions/matchEventToFilter.ts"],"names":[],"mappings":";;;AAGA;;;;;GAKG;AACI,IAAM,kBAAkB,GAAG,UAAC,KAAsD,EAAE,MAAc;IACvG,IAAI;QACF,IAAI,MAAM,CAAC,WAAW,KAAK,0BAA0B,EAAE;YACrD,4CAA4C;YAC5C,OAAO,CACL,MAAM,CAAC,UAAU,KAAK,IAAI;gBAC1B,MAAM,CAAC,aAAa,CAAC,QAAQ,CAAC,KAAK,CAAC,uBAAuB,CAAC,0BAA0B,CAAW,CAAC,CACnG,CAAC;SACH;aAAM,IAAI,MAAM,CAAC,WAAW,KAAK,+BAA+B,EAAE;YACjE,iHAAiH;YACjH,OAAO,CACL,MAAM,CAAC,UAAU,KAAK,qBAAqB;gBAC3C,CAAC,CAAC,KAAK,CAAC,sBAAsB,CAAC,OAAO,CAAC,MAAM,CAAC,aAAa,CAAC,QAAQ,EAAE,CAAC,CACxE,CAAC;SACH;KACF;IAAC,OAAO,KAAK,EAAE;QACd,OAAO,CAAC,KAAK,CAAC,gCAAgC,EAAE,KAAK,CAAC,CAAC;QACvD,OAAO,KAAK,CAAC;KACd;IACD,OAAO,KAAK,CAAC;AACf,CAAC,CAAC;AApBW,QAAA,kBAAkB,sBAoB7B","sourcesContent":["import type { Filter } from '@amplitude/analytics-core/lib/esm/types/element-interactions';\nimport { ElementBasedTimestampedEvent, ElementBasedEvent } from 'src/helpers';\n\n/**\n * Matches an event to a single filter\n * @param event - The event to match\n * @param filter - The filter to match against\n * @returns boolean indicating if the event matches the filter\n */\nexport const matchEventToFilter = (event: ElementBasedTimestampedEvent<ElementBasedEvent>, filter: Filter) => {\n  try {\n    if (filter.subprop_key === '[Amplitude] Element Text') {\n      // TODO: add support for the other operators\n      return (\n        filter.subprop_op === 'is' &&\n        filter.subprop_value.includes(event.targetElementProperties['[Amplitude] Element Text'] as string)\n      );\n    } else if (filter.subprop_key === '[Amplitude] Element Hierarchy') {\n      // Check if the element ancestory matches the CSS selector, always check this last since it is the most expensive\n      return (\n        filter.subprop_op === 'autotrack css match' &&\n        !!event.closestTrackedAncestor.closest(filter.subprop_value.toString())\n      );\n    }\n  } catch (error) {\n    console.error('Error matching event to filter', error);\n    return false;\n  }\n  return false;\n};\n"]}